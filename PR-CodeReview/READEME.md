# PR-CodeReview Extension

This extension leverages AI models to perform automated code reviews on pull requests. It supports both OpenAI's GPT models and Anthropic's Claude models for generating insightful code reviews.

## Inputs

The extension accepts the following inputs:

1. `pull_request_url` (required):
   - Type: string
   - Description: The URL of the pull request to review

2. `openai_api_key` (optional):
   - Type: string
   - Description: Your OpenAI API key for using GPT models
   - Note: Either this or `anthropic_api_key` must be provided

3. `anthropic_api_key` (optional):
   - Type: string
   - Description: Your Anthropic API key for using Claude models
   - Note: Either this or `openai_api_key` must be provided

4. `model` (optional):
   - Type: string
   - Description: The AI model to use for code review
   - Default: "gpt-4"
   - Supported values: "gpt-3.5-turbo", "gpt-4", "claude-2", "claude-instant-1"

5. `github_token` (optional):
   - Type: string
   - Description: GitHub personal access token for accessing private repositories

## Outputs

The extension provides the following outputs:

1. `pull_request_url`:
   - Type: string
   - Description: The original pull request URL (echoed from input)

2. `review`:
   - Type: string
   - Description: A comprehensive code review generated by the AI model, including:
     - A summary of the changes
     - Key observations and potential issues
     - Suggestions for improvement

3. `model_used`:
   - Type: string
   - Description: The AI model used for the code review

## Usage Example

Here's an example of how to use the PR-CodeReview Extension in your workflow configuration:

```yaml
extensions:
  - name: pr-code-review
    image: ghcr.io/orchestrate-ai/pr-code-review:latest
```

## Error Handling

The extension will raise exceptions in the following cases:
- If no pull request URL is provided
- If neither OpenAI nor Anthropic API key is provided
- If an unsupported model is specified

These errors will be caught and reported back through the Redis channel in a production environment.

## Customization

You can customize the behavior of this extension by modifying the prompt used for code review in the `generate_review` function of the `main.py` file.

## Development

To set up the development environment:

1. Clone the repository
2. Install dependencies: `pip install -r requirements.txt`
3. Set up environment variables as specified in the Inputs section
4. Run the script: `python main.py`